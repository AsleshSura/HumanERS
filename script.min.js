class SurvivalSystem{constructor(){this.initialized=!1,this.permissions={camera:!1,microphone:!1,motion:!1},this.models={faceApi:{loaded:!1,model:null,error:null},handpose:{loaded:!1,model:null,error:null},webgazer:{loaded:!1,model:null,error:null}},this.threatLevel=.2,this.lastDisplayedThreat=.2,this.currentThreatLevel=.2,this.emotionScore=.2,this.gestureScore=.2,this.eyeScore=.2,this.motionScore=.2,this.currentEmotions={happy:0,sad:0,angry:0,fearful:0,surprised:0,neutral:.5,disgusted:0},this.fallbackMode=!1,this.debugMode=!1,this.setupKeyboardControls(),this.modelLoadTimeout=15e3,this.audioContext=null,this.oscillators=[],this.gainNode=null,this.analyser=null,this.microphone=null,this.backgroundCanvas=null,this.backgroundCtx=null,this.touchCanvas=null,this.touchCtx=null,this.particles=[],this.touchPoints=[],this.motionData={x:0,y:0,z:0},this.lastMotion=Date.now(),this.threatSymbols={safe:["✨","🏔️","😊","💤"],low:["🌊","🏔️","👁️"],moderate:["👁️","🌀","⭕"],high:["⚠️","🌊","🔥"],danger:["💀","👁️","⚠️","🌪️"]},this.threatColors={safe:["#00ff88","#ffffff","#88ffaa"],low:["#0088ff","#00ff88","#44aaff"],moderate:["#ffff00","#ff8800","#ffaa44"],high:["#ff8800","#ff0000","#ff6600"],danger:["#ff0000","#000000","#660000"]},this.statusMessages=[]}async initialize(){if(!this.initialized){this.log("🚀 Initializing HumanERS components...");try{this.setupEventListeners(),this.setupCanvas(),this.setupAudioContext(),this.updateEmotionDisplay(this.currentEmotions),this.startEmotionSimulation(),this.showUserMessage("System ready! Click the start button to begin.","info"),this.startMainLoop(),this.initialized=!0,this.log("✅ HumanERS initialization complete")}catch(t){this.log("❌ Initialization error:",t),this.showUserMessage("System started in limited mode. Some features may not work.","warning"),this.fallbackMode=!0,this.initialized=!0,this.updateEmotionDisplay(this.currentEmotions)}}}log(t,e=null){const s=(new Date).toLocaleTimeString();console.log(`[${s}] ${t}`,e||""),this.debugMode&&this.showUserMessage(t,"debug")}showUserMessage(t,e="info"){let s=document.getElementById("statusMessages");s||(s=document.createElement("div"),s.id="statusMessages",s.style.cssText="\n                position: fixed;\n                top: 10px;\n                right: 10px;\n                z-index: 10000;\n                max-width: 300px;\n                pointer-events: none;\n            ",document.body.appendChild(s));const i=document.createElement("div");i.style.cssText=`\n            background: ${"error"===e?"rgba(255, 0, 0, 0.9)":"warning"===e?"rgba(255, 255, 0, 0.9)":"success"===e?"rgba(0, 255, 0, 0.9)":"rgba(0, 0, 255, 0.9)"};\n            color: ${"warning"===e?"#000":"#fff"};\n            padding: 10px;\n            margin: 5px 0;\n            border-radius: 5px;\n            font-size: 12px;\n            border: 1px solid rgba(255, 255, 255, 0.3);\n            backdrop-filter: blur(10px);\n            animation: slideIn 0.3s ease-out;\n        `,i.textContent=t,s.appendChild(i),setTimeout(()=>{i.parentNode&&i.remove()},5e3)}setupEventListeners(){this.log("🔧 Setting up event listeners...");const t=document.getElementById("grantPermissions");t?t.addEventListener("click",()=>this.requestPermissions()):this.log("⚠️ Start button not found"),this.setupTouchEvents(),this.setupDeviceMotion(),this.log("✅ Event listeners setup complete")}async requestPermissions(){const t=document.getElementById("permissionModal"),e=document.getElementById("mainInterface");this.showUserMessage("Requesting permissions and loading AI models...","info");try{const s=[this.setupCamera().catch(t=>this.log("⚠️ Camera setup failed:",t.message)),this.setupMicrophone().catch(t=>this.log("⚠️ Microphone setup failed:",t.message))];await Promise.allSettled(s),this.showUserMessage("Loading AI models... This may take a moment.","info"),await this.loadAIModelsWithTimeout(),t&&t.classList.add("hidden"),e&&e.classList.remove("hidden");const i=document.getElementById("emotionPanel");console.log("🔍 Looking for emotion panel:",i),i?(i.classList.remove("hidden"),console.log("✅ Emotion panel displayed")):console.log("❌ Emotion panel not found"),this.startSystem();const o=this.getWorkingFeatures();this.showUserMessage(`System ready! Working features: ${o.join(", ")}`,"success")}catch(s){this.log("❌ Permission setup failed:",s),this.showUserMessage("System started in fallback mode. Limited functionality available.","warning"),this.fallbackMode=!0,t&&t.classList.add("hidden"),e&&e.classList.remove("hidden");const i=document.getElementById("emotionPanel");console.log("🔍 Fallback mode - Looking for emotion panel:",i),i?(i.classList.remove("hidden"),console.log("✅ Fallback mode - Emotion panel displayed")):console.log("❌ Fallback mode - Emotion panel not found"),this.startSystem()}}getWorkingFeatures(){const t=[];return this.permissions.camera&&this.models.faceApi.loaded&&t.push("Emotion Detection"),this.permissions.camera&&this.models.handpose.loaded&&t.push("Gesture Recognition"),this.permissions.microphone&&t.push("Audio Analysis"),this.permissions.motion&&t.push("Motion Detection"),this.models.webgazer.loaded&&t.push("Eye Tracking"),0===t.length&&t.push("Visual Effects","Touch Interaction"),t}async loadAIModelsWithTimeout(){const t=new Promise((t,e)=>setTimeout(()=>e(new Error("Model loading timeout")),this.modelLoadTimeout)),e=[this.loadFaceAPIWithFallback(),this.loadHandposeWithFallback(),this.initWebGazerWithFallback()];try{await Promise.race([Promise.allSettled(e),t])}catch(t){this.log("⚠️ Model loading timeout, continuing without some AI features")}}async loadFaceAPIWithFallback(){try{if("undefined"==typeof faceapi)throw new Error("Face-API.js library not loaded");this.log("📥 Loading Face-API models...");const t="https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights";await Promise.race([faceapi.nets.tinyFaceDetector.loadFromUri(t),new Promise((t,e)=>setTimeout(()=>e(new Error("TinyFaceDetector timeout")),1e4))]),await Promise.race([faceapi.nets.faceLandmark68Net.loadFromUri(t),new Promise((t,e)=>setTimeout(()=>e(new Error("FaceLandmark timeout")),1e4))]),await Promise.race([faceapi.nets.faceExpressionNet.loadFromUri(t),new Promise((t,e)=>setTimeout(()=>e(new Error("FaceExpression timeout")),1e4))]),this.models.faceApi.loaded=!0,this.models.faceApi.model=faceapi,this.updateStatusIndicator("camera-status",!0),this.log("✅ Face-API models loaded successfully")}catch(t){this.models.faceApi.error=t.message,this.log("❌ Face-API loading failed:",t.message),this.updateStatusIndicator("camera-status",!1)}}async loadHandposeWithFallback(){try{if("undefined"==typeof handpose)throw new Error("HandPose library not loaded");this.log("📥 Loading HandPose model..."),this.models.handpose.model=await Promise.race([handpose.load(),new Promise((t,e)=>setTimeout(()=>e(new Error("HandPose timeout")),1e4))]),this.models.handpose.loaded=!0,this.updateStatusIndicator("gesture-status",!0),this.log("✅ HandPose model loaded successfully")}catch(t){this.models.handpose.error=t.message,this.log("❌ HandPose loading failed:",t.message),this.updateStatusIndicator("gesture-status",!1)}}async initWebGazerWithFallback(){try{if("undefined"==typeof webgazer)throw new Error("WebGazer library not loaded");this.log("📥 Initializing WebGazer..."),await Promise.race([webgazer.setGazeListener((t,e)=>{t&&(this.eyePosition={x:t.x/window.innerWidth,y:t.y/window.innerHeight})}).begin(),new Promise((t,e)=>setTimeout(()=>e(new Error("WebGazer timeout")),1e4))]),webgazer.showVideoPreview(!1).showPredictionPoints(!1),this.models.webgazer.loaded=!0,this.models.webgazer.model=webgazer,this.updateStatusIndicator("eye-status",!0),this.log("✅ WebGazer initialized successfully")}catch(t){this.models.webgazer.error=t.message,this.log("❌ WebGazer initialization failed:",t.message),this.updateStatusIndicator("eye-status",!1)}}setupCanvas(){this.log("🎨 Setting up canvas elements..."),this.backgroundCanvas=document.getElementById("backgroundCanvas"),this.touchCanvas=document.getElementById("touchCanvas"),this.backgroundCanvas||(this.log("⚠️ Background canvas not found, creating fallback"),this.backgroundCanvas=this.createFallbackCanvas("backgroundCanvas")),this.touchCanvas||(this.log("⚠️ Touch canvas not found, creating fallback"),this.touchCanvas=this.createFallbackCanvas("touchCanvas"));try{this.backgroundCtx=this.backgroundCanvas.getContext("2d"),this.touchCtx=this.touchCanvas.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas()),this.log("✅ Canvas setup complete")}catch(t){this.log("❌ Canvas setup failed:",t)}}createFallbackCanvas(t){const e=document.createElement("canvas");return e.id=t,e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="touchCanvas"===t?"auto":"none",e.style.zIndex="touchCanvas"===t?"100":"1",document.body.appendChild(e),e}resizeCanvas(){this.backgroundCanvas&&(this.backgroundCanvas.width=window.innerWidth,this.backgroundCanvas.height=window.innerHeight),this.touchCanvas&&(this.touchCanvas.width=window.innerWidth,this.touchCanvas.height=window.innerHeight)}setupAudioContext(){try{if(this.audioContext=new(window.AudioContext||window.webkitAudioContext),"suspended"===this.audioContext.state){this.log("🔊 Audio context suspended, will resume on user interaction");const t=()=>{"suspended"===this.audioContext.state&&this.audioContext.resume().then(()=>{this.log("🔊 Audio context resumed")}),document.removeEventListener("click",t),document.removeEventListener("touchstart",t)};document.addEventListener("click",t),document.addEventListener("touchstart",t)}this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.log("✅ Audio context setup complete")}catch(t){this.log("❌ Audio context setup failed:",t)}}async setupCamera(){try{const t=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480}}),e=document.getElementById("video");e&&(e.srcObject=t,e.onloadedmetadata=()=>{this.permissions.camera=!0,this.updateStatusIndicator("camera-status",!0),this.log("✅ Camera setup successful")})}catch(t){throw this.log("❌ Camera setup failed:",t.message),t}}async setupMicrophone(){try{const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.audioContext&&(this.microphone=this.audioContext.createMediaStreamSource(t),this.microphone.connect(this.analyser),this.permissions.microphone=!0,this.updateStatusIndicator("mic-status",!0),this.log("✅ Microphone setup successful"))}catch(t){throw this.log("❌ Microphone setup failed:",t.message),t}}setupDeviceMotion(){"undefined"!=typeof DeviceMotionEvent&&("function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then(t=>{"granted"===t&&this.enableDeviceMotion()}).catch(console.error):this.enableDeviceMotion())}enableDeviceMotion(){window.addEventListener("devicemotion",t=>{const e=t.accelerationIncludingGravity;if(e){this.motionData={x:e.x||0,y:e.y||0,z:e.z||0};const t=Math.sqrt(this.motionData.x**2+this.motionData.y**2+this.motionData.z**2);t>15&&(this.motionScore=Math.min(1,t/20),this.lastMotion=Date.now()),this.permissions.motion=!0,this.updateStatusIndicator("motion-status",!0)}})}updateStatusIndicator(t,e){const s=document.querySelector(`.${t}`);s&&(e?(s.classList.add("active"),s.classList.remove("error")):(s.classList.remove("active"),s.classList.add("error")))}startSystem(){this.log("🎬 Starting system components..."),this.permissions.camera&&(this.models.faceApi.loaded?this.startFaceDetection():(this.log("📺 Face detection unavailable - using fallback emotion simulation"),this.startEmotionSimulation()),this.models.handpose.loaded?this.startHandDetection():(this.log("✋ Hand detection unavailable - using fallback gesture simulation"),this.startGestureSimulation())),this.startRenderLoop(),this.startThreatAssessment(),this.log("🚀 System fully operational!")}startEmotionSimulation(){setInterval(()=>{const t=Date.now()/1e3,e=this.touchPoints.length;this.currentEmotions={happy:Math.max(0,Math.min(1,.3+.2*Math.sin(.1*t)+(e>0?.3:0))),sad:Math.max(0,Math.min(1,.1+.1*Math.sin(.05*t))),angry:Math.max(0,Math.min(1,.05+(e>3?.4:0)+.1*Math.random())),fearful:Math.max(0,Math.min(1,.1+(this.motionScore>.5?.3:0))),surprised:Math.max(0,Math.min(1,.05+(e>0?.2:0)*Math.random())),neutral:Math.max(0,Math.min(1,.4-.1*e)),disgusted:Math.max(0,Math.min(1,.02+.05*Math.random()))},this.updateEmotionDisplay(this.currentEmotions);const s=this.currentEmotions.fearful+this.currentEmotions.surprised+this.currentEmotions.angry;if(this.emotionScore=Math.min(1,s),this.debugMode){const t=Object.keys(this.currentEmotions).reduce((t,e)=>this.currentEmotions[t]>this.currentEmotions[e]?t:e);this.log(`🎭 Simulated emotion: ${t} (${(100*this.currentEmotions[t]).toFixed(1)}%)`)}},1e3)}startGestureSimulation(){setInterval(()=>{const t=this.touchPoints.length/10;this.gestureScore=Math.max(.1,.95*this.gestureScore+t)},100)}startFaceDetection(){const t=document.getElementById("video");if(!t||!this.models.faceApi.loaded)return;const e=async()=>{try{if(4===t.readyState){const e=await this.models.faceApi.model.detectAllFaces(t,new this.models.faceApi.model.TinyFaceDetectorOptions).withFaceExpressions();if(e.length>0){const t=e[0].expressions;this.processEmotions(t)}else this.emotionScore=Math.max(.1,.98*this.emotionScore)}}catch(t){return this.log("❌ Face detection error:",t.message),void this.startEmotionSimulation()}setTimeout(e,100)};e()}startHandDetection(){const t=document.getElementById("video");if(!t||!this.models.handpose.loaded)return;const e=async()=>{try{if(4===t.readyState){const e=await this.models.handpose.model.estimateHands(t);this.processGestures(e)}}catch(t){return this.log("❌ Hand detection error:",t.message),void this.startGestureSimulation()}setTimeout(e,100)};e()}processEmotions(t){try{const e=.6,s={happy:t.happy||0,sad:t.sad||0,angry:t.angry||0,fearful:t.fearful||0,surprised:t.surprised||0,neutral:t.neutral||0,disgusted:t.disgusted||0};this.currentEmotions?Object.keys(s).forEach(t=>{this.currentEmotions[t]=this.currentEmotions[t]*(1-e)+s[t]*e}):this.currentEmotions=s,this.updateEmotionDisplay(this.currentEmotions);const i=1*this.currentEmotions.fearful+.8*this.currentEmotions.angry+.3*this.currentEmotions.surprised+.4*this.currentEmotions.sad,o=1*this.currentEmotions.happy+.5*this.currentEmotions.neutral;this.emotionScore=Math.max(0,Math.min(1,i-.7*o+.1));if(Object.values(this.currentEmotions).reduce((t,e)=>t+e,0)<.1&&(this.emotionScore=.1),this.debugMode){const t=Object.keys(this.currentEmotions).reduce((t,e)=>this.currentEmotions[t]>this.currentEmotions[e]?t:e);this.log(`🎭 Dominant emotion: ${t} (${(100*this.currentEmotions[t]).toFixed(1)}%)`),this.log(`⚡ Emotion score: ${(100*this.emotionScore).toFixed(1)}%`)}}catch(t){this.log("❌ Emotion processing error:",t.message)}}updateEmotionDisplay(t){try{["happy","sad","angry","fearful","surprised","neutral","disgusted"].forEach(e=>{const s=100*(t[e]||0),i=document.getElementById(`${e}-bar`),o=document.getElementById(`${e}-value`);i&&o&&(i.style.width=`${s}%`,o.textContent=`${s.toFixed(1)}%`)});const e=100*Math.max(...Object.values(t)),s=document.getElementById("intensity-fill"),i=document.getElementById("intensity-value");s&&i&&(s.style.width=`${e}%`,i.textContent=`${e.toFixed(1)}%`,i.style.color=e>70?"#ff4444":e>40?"#ffaa00":"#00ff88")}catch(t){this.log("❌ Emotion display error:",t.message)}}processGestures(t){try{if(0===t.length)return void(this.gestureScore=Math.max(.1,.95*this.gestureScore));const e=t[0].landmarks,s=this.calculateFingerSpread(e),i=this.calculateHandShake(e);this.gestureScore=Math.min(1,(i+s)/2)}catch(t){this.log("❌ Gesture processing error:",t.message)}}calculateFingerSpread(t){try{const e=[4,8,12,16,20];let s=0;for(let i=0;i<e.length-1;i++){const o=t[e[i]],a=t[e[i+1]];s+=Math.sqrt((o[0]-a[0])**2+(o[1]-a[1])**2)}return Math.min(1,s/500)}catch(t){return 0}}calculateHandShake(t){try{const e=t[0],s=Date.now();if(!this.lastWristPosition)return this.lastWristPosition={x:e[0],y:e[1],time:s},0;const i=s-this.lastWristPosition.time;if(i<50)return this.lastHandShake||0;const o=Math.sqrt((e[0]-this.lastWristPosition.x)**2+(e[1]-this.lastWristPosition.y)**2)/i;return this.lastWristPosition={x:e[0],y:e[1],time:s},this.lastHandShake=Math.min(1,10*o),this.lastHandShake}catch(t){return 0}}setupTouchEvents(){const t=this.touchCanvas;if(!t)return;const e=(t,e)=>{this.touchPoints.push({x:t,y:e,intensity:.5*Math.random()+.5,life:1,decay:.02})};t.addEventListener("touchstart",s=>{s.preventDefault();for(let i of s.touches){const s=t.getBoundingClientRect();e(i.clientX-s.left,i.clientY-s.top)}}),t.addEventListener("touchmove",s=>{s.preventDefault();for(let i of s.touches){const s=t.getBoundingClientRect();e(i.clientX-s.left,i.clientY-s.top)}}),t.addEventListener("mousedown",s=>{const i=t.getBoundingClientRect();e(s.clientX-i.left,s.clientY-i.top)}),t.addEventListener("mousemove",s=>{if(s.buttons>0){const i=t.getBoundingClientRect();e(s.clientX-i.left,s.clientY-i.top)}})}startMainLoop(){const t=()=>{this.paused||(this.updateParticles(),this.updateTouchPoints(),this.updateThreatLevel(),this.updateEmotionDisplay(this.currentEmotions),this.render()),requestAnimationFrame(t)};t()}startRenderLoop(){}startThreatAssessment(){setInterval(()=>{if(this.paused)return;const t=.5,e=.4,s=.05,i=.05;this.threatLevel=Math.min(1,this.emotionScore*t+this.gestureScore*e+this.eyeScore*s+this.motionScore*i),this.updateThreatDisplay()},100)}updateThreatLevel(){const t=this.threatLevel,e=this.currentThreatLevel||this.threatLevel;this.currentThreatLevel=e+.1*(t-e)}updateThreatDisplay(){const t=document.getElementById("threatSymbol");if(!t)return;if(this.lastDisplayedThreat&&Math.abs(this.threatLevel-this.lastDisplayedThreat)<.05)return;this.lastDisplayedThreat=this.threatLevel;const e=Math.floor(5*this.threatLevel),s=[this.threatSymbols.safe,this.threatSymbols.low,this.threatSymbols.moderate,this.threatSymbols.high,this.threatSymbols.danger],i=s[Math.min(e,s.length-1)],o=i[Math.floor(this.threatLevel*i.length)%i.length];t.textContent=o,this.updateIntensityBar()}updateIntensityBar(){const t=document.getElementById("intensity-fill");document.querySelector(".intensity-meter");if(t){const e=100*this.threatLevel;t.style.height=`${e}%`,this.threatLevel>.8?t.style.background="linear-gradient(to top, #ff0000, #ff4444)":this.threatLevel>.6?t.style.background="linear-gradient(to top, #ff8800, #ffaa00)":this.threatLevel>.4?t.style.background="linear-gradient(to top, #ffff00, #ffff88)":this.threatLevel>.2?t.style.background="linear-gradient(to top, #88ff00, #aaffaa)":t.style.background="linear-gradient(to top, #00ff00, #88ffaa)"}}updateParticles(){Math.random()<.1*this.threatLevel&&this.particles.push({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,vx:4*(Math.random()-.5),vy:4*(Math.random()-.5),life:1,decay:.01+.02*Math.random()}),this.particles=this.particles.filter(t=>(t.x+=t.vx,t.y+=t.vy,t.life-=t.decay,t.life>0)),this.particles.length>200&&(this.particles=this.particles.slice(-200))}updateTouchPoints(){this.touchPoints=this.touchPoints.filter(t=>(t.life-=t.decay,t.life>0))}render(){this.backgroundCtx&&this.touchCtx&&(this.backgroundCtx.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height),this.touchCtx.clearRect(0,0,this.touchCanvas.width,this.touchCanvas.height),this.renderBackground(),this.renderParticles(),this.renderTouchPoints())}renderBackground(){const t=Math.floor(5*this.threatLevel),e=[this.threatColors.safe,this.threatColors.low,this.threatColors.moderate,this.threatColors.high,this.threatColors.danger],s=e[Math.min(t,e.length-1)],i=this.backgroundCtx.createRadialGradient(window.innerWidth/2,window.innerHeight/2,0,window.innerWidth/2,window.innerHeight/2,Math.max(window.innerWidth,window.innerHeight));i.addColorStop(0,s[0]+"40"),i.addColorStop(1,s[1]+"20"),this.backgroundCtx.fillStyle=i,this.backgroundCtx.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height)}renderParticles(){this.particles.forEach(t=>{this.backgroundCtx.save(),this.backgroundCtx.globalAlpha=t.life,this.backgroundCtx.fillStyle="#ffffff",this.backgroundCtx.beginPath(),this.backgroundCtx.arc(t.x,t.y,2,0,2*Math.PI),this.backgroundCtx.fill(),this.backgroundCtx.restore()})}renderTouchPoints(){this.touchPoints.forEach(t=>{this.touchCtx.save(),this.touchCtx.globalAlpha=t.life*t.intensity,this.touchCtx.fillStyle="#ffffff",this.touchCtx.beginPath(),this.touchCtx.arc(t.x,t.y,10*t.life,0,2*Math.PI),this.touchCtx.fill(),this.touchCtx.restore()})}setupKeyboardControls(){document.addEventListener("keydown",t=>{switch(t.key.toLowerCase()){case"r":this.resetSystem(),this.log("🔄 System reset");break;case"d":this.debugMode=!this.debugMode,this.log("🐛 Debug mode: "+(this.debugMode?"ON":"OFF"));break;case"h":this.log("⌨️ Keyboard Controls: R = Reset, D = Debug, H = Help")}})}resetSystem(){this.threatLevel=.2,this.lastDisplayedThreat=.2,this.currentThreatLevel=.2,this.emotionScore=.1,this.gestureScore=0,this.eyeScore=0,this.motionScore=0,this.currentEmotions={happy:0,sad:0,angry:0,fearful:0,surprised:0,neutral:.5,disgusted:0},this.updateThreatDisplay(),this.updateIntensityBar(),this.updateEmotionDisplay(this.currentEmotions)}}let survivalSystem;document.addEventListener("DOMContentLoaded",()=>{console.log("🚀 Starting Enhanced HumanERS System...");const t=document.createElement("style");t.textContent="\n        @keyframes slideIn {\n            from { transform: translateX(100%); opacity: 0; }\n            to { transform: translateX(0); opacity: 1; }\n        }\n        .status-dot.active {\n            background: #00ff00 !important;\n            animation: pulse 2s infinite;\n        }\n        .status-dot.error {\n            background: #ff0000 !important;\n            animation: shake 0.5s ease-in-out;\n        }\n        @keyframes pulse {\n            0%, 100% { opacity: 1; }\n            50% { opacity: 0.5; }\n        }\n        @keyframes shake {\n            0%, 100% { transform: translateX(0); }\n            25% { transform: translateX(-5px); }\n            75% { transform: translateX(5px); }\n        }\n    ",document.head.appendChild(t);try{survivalSystem=new SurvivalSystem,survivalSystem.initialize(),window.survivalSystem=survivalSystem,console.log("✅ Enhanced HumanERS System initialized successfully")}catch(t){console.error("❌ Failed to initialize Enhanced HumanERS:",t);const e=document.getElementById("permissionModal"),s=document.getElementById("mainInterface"),i=document.getElementById("emotionPanel");e&&e.classList.add("hidden"),s&&s.classList.remove("hidden"),console.log("🔍 Error fallback - Looking for emotion panel:",i),i?(i.classList.remove("hidden"),console.log("✅ Error fallback - Emotion panel displayed")):console.log("❌ Error fallback - Emotion panel not found")}}),document.addEventListener("visibilitychange",()=>{survivalSystem&&("hidden"===document.visibilityState?survivalSystem.paused=!0:"visible"===document.visibilityState&&(survivalSystem.paused=!1))}),"undefined"!=typeof window&&(window.survivalSystem=survivalSystem);